{"Constants": {"L": {"dim": 1, "values": [2.5999999046325684]},
               "delta_sw_map": {"dim": [100, 1],
                                "values": [[-12.566370964050293],
                                           [-12.317667007446289],
                                           [-12.06896686553955],
                                           [-11.820265769958496],
                                           [-11.571565628051758],
                                           [-11.322864532470703],
                                           [-11.074164390563965],
                                           [-10.82546329498291],
                                           [-10.576762199401855],
                                           [-10.328062057495117],
                                           [-10.079360961914062],
                                           [-9.830660820007324],
                                           [-9.579911231994629],
                                           [-9.328554153442383],
                                           [-9.077197074890137],
                                           [-8.82583999633789],
                                           [-8.574483871459961],
                                           [-8.323126792907715],
                                           [-8.071769714355469],
                                           [-7.820413112640381],
                                           [-7.569056510925293],
                                           [-7.317699432373047],
                                           [-7.066342830657959],
                                           [-6.812581539154053],
                                           [-6.557591438293457],
                                           [-6.302600860595703],
                                           [-6.047610759735107],
                                           [-5.792620658874512],
                                           [-5.537630081176758],
                                           [-5.282639980316162],
                                           [-5.027649402618408],
                                           [-4.7726593017578125],
                                           [-4.517668724060059],
                                           [-4.262678623199463],
                                           [-4.0055389404296875],
                                           [-3.7475228309631348],
                                           [-3.489506483078003],
                                           [-3.231490135192871],
                                           [-2.97347354888916],
                                           [-2.7154572010040283],
                                           [-2.4574408531188965],
                                           [-2.1994245052337646],
                                           [-1.9414081573486328],
                                           [-1.683391809463501],
                                           [-1.4253754615783691],
                                           [-1.1663240194320679],
                                           [-0.9071409106254578],
                                           [-0.6479577422142029],
                                           [-0.3887746334075928],
                                           [-0.12959150969982147],
                                           [0.12959161400794983],
                                           [0.3887747526168823],
                                           [0.6479578614234924],
                                           [0.9071409702301025],
                                           [1.1663241386413574],
                                           [1.4253755807876587],
                                           [1.6833919286727905],
                                           [1.9414082765579224],
                                           [2.1994247436523438],
                                           [2.4574410915374756],
                                           [2.7154574394226074],
                                           [2.9734737873077393],
                                           [3.231490135192871],
                                           [3.489506483078003],
                                           [3.7475228309631348],
                                           [4.005539417266846],
                                           [4.262678623199463],
                                           [4.517669200897217],
                                           [4.7726593017578125],
                                           [5.027649402618408],
                                           [5.282639980316162],
                                           [5.537630081176758],
                                           [5.792620658874512],
                                           [6.047610759735107],
                                           [6.302601337432861],
                                           [6.557591438293457],
                                           [6.812581539154053],
                                           [7.066342830657959],
                                           [7.317699909210205],
                                           [7.569056510925293],
                                           [7.820413112640381],
                                           [8.071769714355469],
                                           [8.323126792907715],
                                           [8.574483871459961],
                                           [8.825840950012207],
                                           [9.077197074890137],
                                           [9.328554153442383],
                                           [9.579911231994629],
                                           [9.830660820007324],
                                           [10.079361915588379],
                                           [10.328062057495117],
                                           [10.576763153076172],
                                           [10.82546329498291],
                                           [11.074164390563965],
                                           [11.322864532470703],
                                           [11.571565628051758],
                                           [11.820265769958496],
                                           [12.06896686553955],
                                           [12.317667007446289],
                                           [12.566368103027344]]},
               "delta_w_avg_map": {"dim": [100, 1],
                                   "values": [[-0.6417303085327148],
                                              [-0.6287660598754883],
                                              [-0.6158018112182617],
                                              [-0.6028375625610352],
                                              [-0.5898733139038086],
                                              [-0.576909065246582],
                                              [-0.5639448165893555],
                                              [-0.5509805679321289],
                                              [-0.5380163192749023],
                                              [-0.5250520706176758],
                                              [-0.5120878219604492],
                                              [-0.49912354350090027],
                                              [-0.4861592948436737],
                                              [-0.47319504618644714],
                                              [-0.4602307975292206],
                                              [-0.447266548871994],
                                              [-0.43430230021476746],
                                              [-0.4213380515575409],
                                              [-0.40837380290031433],
                                              [-0.39540955424308777],
                                              [-0.3824453353881836],
                                              [-0.36948108673095703],
                                              [-0.35651683807373047],
                                              [-0.3435525894165039],
                                              [-0.33058834075927734],
                                              [-0.3176240921020508],
                                              [-0.3046598434448242],
                                              [-0.29169559478759766],
                                              [-0.2787313461303711],
                                              [-0.26576709747314453],
                                              [-0.25280284881591797],
                                              [-0.2398385852575302],
                                              [-0.22687433660030365],
                                              [-0.2139100879430771],
                                              [-0.20094583928585052],
                                              [-0.18798160552978516],
                                              [-0.1750173568725586],
                                              [-0.16205310821533203],
                                              [-0.14908885955810547],
                                              [-0.1361246109008789],
                                              [-0.12316035479307175],
                                              [-0.11019610613584518],
                                              [-0.09723185747861862],
                                              [-0.08426761627197266],
                                              [-0.0713033676147461],
                                              [-0.05833911523222923],
                                              [-0.04537487030029297],
                                              [-0.032410621643066406],
                                              [-0.019446372985839844],
                                              [-0.006482123862951994],
                                              [0.006482123862951994],
                                              [0.019446372985839844],
                                              [0.032410621643066406],
                                              [0.04537487030029297],
                                              [0.05833911523222923],
                                              [0.0713033676147461],
                                              [0.08426761627197266],
                                              [0.09723185747861862],
                                              [0.11019610613584518],
                                              [0.12316035479307175],
                                              [0.1361246109008789],
                                              [0.14908885955810547],
                                              [0.16205310821533203],
                                              [0.1750173568725586],
                                              [0.18798160552978516],
                                              [0.20094583928585052],
                                              [0.2139100879430771],
                                              [0.22687433660030365],
                                              [0.2398385852575302],
                                              [0.25280284881591797],
                                              [0.26576709747314453],
                                              [0.2787313461303711],
                                              [0.29169559478759766],
                                              [0.3046598434448242],
                                              [0.3176240921020508],
                                              [0.33058834075927734],
                                              [0.3435525894165039],
                                              [0.35651683807373047],
                                              [0.36948108673095703],
                                              [0.3824453353881836],
                                              [0.39540955424308777],
                                              [0.40837380290031433],
                                              [0.4213380515575409],
                                              [0.43430230021476746],
                                              [0.447266548871994],
                                              [0.4602307975292206],
                                              [0.47319504618644714],
                                              [0.4861592948436737],
                                              [0.49912354350090027],
                                              [0.5120878219604492],
                                              [0.5250520706176758],
                                              [0.5380163192749023],
                                              [0.5509805679321289],
                                              [0.5639448165893555],
                                              [0.576909065246582],
                                              [0.5898733139038086],
                                              [0.6028375625610352],
                                              [0.6158018112182617],
                                              [0.6287660598754883],
                                              [0.6417303085327148]]}},
 "Functions": {"FParamFun29": {"code": "def curvat_diagram(curv,L,h_1,h_2,h_3):\n  return torch.atan(h_1*curv + h_2*torch.pow(curv,3) + h_3*torch.pow(curv,5) + curv*L)\n",
                               "in_dim": [{"dim": 1, "sw": 15}],
                               "map_over_dim": false,
                               "n_input": 1,
                               "name": "curvat_diagram",
                               "params_and_consts": ["L", "h_1", "h_2", "h_3"]},
               "FParamFun34": {"code": "def linear_interp(x,x_data,y_data):\n    # Inputs: \n    # x: query point, a tensor of shape torch.Size([N, 1, 1])\n    # x_data: map of x values, sorted in ascending order, a tensor of shape torch.Size([Q, 1])\n    # y_data: map of y values, a tensor of shape torch.Size([Q, 1])\n    # Output:\n    # y: interpolated value at x, a tensor of shape torch.Size([N, 1, 1])\n\n    # Saturate x to the range of x_data\n    x = torch.min(torch.max(x,x_data[0]),x_data[-1])\n\n    # Find the index of the closest value in x_data\n    idx = torch.argmin(torch.abs(x_data[:-1] - x),dim=1)\n\n    # Linear interpolation\n    y = y_data[idx] + (y_data[idx+1] - y_data[idx])/(x_data[idx+1] - x_data[idx])*(x - x_data[idx])\n    return y\n",
                               "in_dim": [{"dim": 1, "sw": 1}],
                               "map_over_dim": false,
                               "n_input": 1,
                               "name": "linear_interp",
                               "params_and_consts": ["delta_w_avg_map",
                                                     "delta_sw_map"]}},
 "Info": {"SampleTime": 1, "ns": [15, 15], "ntot": 30},
 "Inputs": {"curv": {"dim": 1,
                     "ns": [0, 15],
                     "ntot": 15,
                     "sw": [0, 15],
                     "tw": [0, 0]},
            "steer": {"dim": 1,
                      "ns": [15, 0],
                      "ntot": 15,
                      "sw": [-15, 0],
                      "tw": [0, 0]},
            "steer_target": {"dim": 1,
                             "ns": [0, 1],
                             "ntot": 1,
                             "sw": [0, 1],
                             "tw": [0, 0]}},
 "Minimizers": {"steer_error": {"A": "SamplePart17",
                                "B": "steering_angle",
                                "loss": "mse"}},
 "Models": "steer_ctrl",
 "Outputs": {"steering_angle": "Add15"},
 "Parameters": {"fir_auto_regression": {"dim": 1,
                                        "sw": 15,
                                        "values": [[0.027331391349434853],
                                                   [0.013913577422499657],
                                                   [0.0027207101229578257],
                                                   [-0.006245761178433895],
                                                   [-0.012935416772961617],
                                                   [-0.017147129401564598],
                                                   [-0.018340807408094406],
                                                   [-0.015591145493090153],
                                                   [-0.007923259399831295],
                                                   [0.00498045003041625],
                                                   [0.022115416824817657],
                                                   [0.04109988734126091],
                                                   [0.058815181255340576],
                                                   [0.07218976318836212],
                                                   [0.07853253930807114]]},
                "fir_future_curv": {"dim": 1,
                                    "sw": 15,
                                    "values": [[0.23345181345939636],
                                               [0.19194616377353668],
                                               [0.15049412846565247],
                                               [0.10870631039142609],
                                               [0.06920742988586426],
                                               [0.03615035116672516],
                                               [0.012384435161948204],
                                               [-0.0022142089437693357],
                                               [-0.010074432939291],
                                               [-0.013929738663136959],
                                               [-0.01528158038854599],
                                               [-0.014231100678443909],
                                               [-0.010272489860653877],
                                               [-0.00324339815415442],
                                               [0.006186020094901323]]},
                "h_1": {"dim": [1, 1], "values": [[0.060368265956640244]]},
                "h_2": {"dim": [1, 1], "values": [[2.493232250213623]]},
                "h_3": {"dim": [1, 1], "values": [[-7.702671527862549]]}},
 "Relations": {"Add15": ["Add", ["ParamFun11", "Fir14"]],
               "Fir10": ["Fir", ["ParamFun9"], "fir_future_curv", null, 0],
               "Fir14": ["Fir",
                         ["SamplePart13"],
                         "fir_auto_regression",
                         null,
                         0],
               "ParamFun11": ["ParamFun", ["Fir10"], "FParamFun34"],
               "ParamFun9": ["ParamFun", ["SamplePart8"], "FParamFun29"],
               "SamplePart13": ["SamplePart", ["steer"], -1, [-15, 0]],
               "SamplePart17": ["SamplePart", ["steer_target"], -1, [0, 1]],
               "SamplePart8": ["SamplePart", ["curv"], -1, [0, 15]]},
 "States": {}}